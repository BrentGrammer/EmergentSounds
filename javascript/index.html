<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Destructive Interference</title>
    <link rel="stylesheet" href="./main.css" />
  </head>

  <body>
    <h1>Destructive Interference</h1>
    <p>Click the buttons for sound results.</p>
    <button id="osc1">Play Oscillator 1</button>
    <button id="osc2">Play Oscillator 2</button>
    <button id="both">Both - Destructive Interference</button>

    <script>
      const AudioContext = window.AudioContext || window.webkitAudioContext;
      const audioCtx = new AudioContext();

      function createOscillator({ frequency = 440, type = "sine" } = {}) {
        const osc = audioCtx.createOscillator();
        osc.type = type;
        osc.frequency.setValueAtTime(frequency, audioCtx.currentTime);
        return osc;
      }

      function play({ gain = 1, frequency = 440, type = "sine" } = {}) {
        const osc = createOscillator({ frequency, type });
        const gainNode = audioCtx.createGain();
        gainNode.gain.setValueAtTime(1, audioCtx.currentTime);
        osc.connect(gainNode).connect(audioCtx.destination);

        osc.start();
        setTimeout(() => {
          osc.stop();
        }, 2000);
      }

      document.getElementById("osc1").addEventListener("click", () => {
        play({ gain: 1, frequency: 440, type: "sine" });
      });
      document.getElementById("osc2").addEventListener("click", () => {
        play({ gain: -1, frequency: 440, type: "sine" });
      });

      document.getElementById("both").addEventListener("click", () => {
        play({ gain: 1, frequency: 440, type: "sine" });
        // Set gain to -1 so wave crests align with wave troughs above
        play({ gain: -1, frequency: 440, type: "sine" });
      });
    </script>
  </body>
</html>
